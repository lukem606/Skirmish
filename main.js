(()=>{"use strict";var t={426:(t,e,n)=>{n.d(e,{Z:()=>d});var i=n(537),a=n.n(i),o=n(645),r=n.n(o),s=n(667),l=n.n(s),u=new URL(n(872),n.b),c=new URL(n(562),n.b),h=r()(a()),f=l()(u),v=l()(c);h.push([t.id,'@font-face {\n  font-family: "PressStart2P";\n  font-style: normal;\n  font-weight: 400;\n  src: url('+f+')\n    format("woff2");\n  src: url('+v+') format("woff");\n}\n\nbody {\n  background-color: rgb(0, 0, 0);\n  margin: 0;\n}\n',"",{version:3,sources:["webpack://./src/style.css"],names:[],mappings:"AAAA;EACE,2BAA2B;EAC3B,kBAAkB;EAClB,gBAAgB;EAChB;mBACiB;EACjB,2DAA8E;AAChF;;AAEA;EACE,8BAA8B;EAC9B,SAAS;AACX",sourcesContent:['@font-face {\n  font-family: "PressStart2P";\n  font-style: normal;\n  font-weight: 400;\n  src: url("./assets/fonts/press-start-2p-v9-latin-regular.woff2")\n    format("woff2");\n  src: url("./assets/fonts/press-start-2p-v9-latin-regular.woff") format("woff");\n}\n\nbody {\n  background-color: rgb(0, 0, 0);\n  margin: 0;\n}\n'],sourceRoot:""}]);const d=h},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,a,o){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(i)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(r[l]=!0)}for(var u=0;u<t.length;u++){var c=[].concat(t[u]);i&&r[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),e.push(c))}},e}},667:t=>{t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},537:t=>{t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),o="/*# ".concat(a," */"),r=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[e].concat(r).concat([o]).join("\n")}return[e].join("\n")}},379:t=>{var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var o={},r=[],s=0;s<t.length;s++){var l=t[s],u=i.base?l[0]+i.base:l[0],c=o[u]||0,h="".concat(u," ").concat(c);o[u]=c+1;var f=n(h),v={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==f)e[f].references++,e[f].updater(v);else{var d=a(v,i);i.byIndex=s,e.splice(s,0,{identifier:h,updater:d,references:1})}r.push(h)}return r}function a(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,a){var o=i(t=t||[],a=a||{});return function(t){t=t||[];for(var r=0;r<o.length;r++){var s=n(o[r]);e[s].references--}for(var l=i(t,a),u=0;u<o.length;u++){var c=n(o[u]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}o=l}}},569:t=>{var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,a&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},562:(t,e,n)=>{t.exports=n.p+"fonts/press-start-2p-v9-latin-regular.woff"},872:(t,e,n)=>{t.exports=n.p+"fonts/press-start-2p-v9-latin-regular.woff2"}},e={};function n(i){var a=e[i];if(void 0!==a)return a.exports;var o=e[i]={id:i,exports:{}};return t[i](o,o.exports,n),o.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.p="/Skirmish/",n.b=document.baseURI||self.location.href,(()=>{var t,e=new Uint8Array(16);function i(){if(!t&&!(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(e)}const a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,o=function(t){return"string"==typeof t&&a.test(t)};for(var r=[],s=0;s<256;++s)r.push((s+256).toString(16).substr(1));const l=function(t,e,n){var a=(t=t||{}).random||(t.rng||i)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,e){n=n||0;for(var s=0;s<16;++s)e[n+s]=a[s];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(r[t[e+0]]+r[t[e+1]]+r[t[e+2]]+r[t[e+3]]+"-"+r[t[e+4]]+r[t[e+5]]+"-"+r[t[e+6]]+r[t[e+7]]+"-"+r[t[e+8]]+r[t[e+9]]+"-"+r[t[e+10]]+r[t[e+11]]+r[t[e+12]]+r[t[e+13]]+r[t[e+14]]+r[t[e+15]]).toLowerCase();if(!o(n))throw TypeError("Stringified UUID is invalid");return n}(a)};function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var c=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e||0,this.y=n||0,this.z=i||0}var e,n,i;return e=t,i=[{key:"add",value:function(e,n){return new t(e.x+n.x,e.y+n.y,e.z+n.z)}},{key:"sub",value:function(e,n){return new t(e.x-n.x,e.y-n.y,e.z-n.z)}},{key:"mult",value:function(e,n){return new t(e.x*n,e.y*n,e.z*n)}},{key:"div",value:function(e,n){var i,a,o;return 0!==n?(i=e.x/n,a=e.y/n,o=e.z/n):(console.warn("Dividing by zero!"),i=e.x,a=e.y,o=e.z_),new t(i,a,o)}},{key:"fromAngle2d",value:function(e){return new t(Math.cos(e),Math.sin(e))}},{key:"fromAngle3d",value:function(t,e){var n=Math.cos(e),i=Math.sin(e),a=Math.cos(t),o=Math.sin(t);return new p5.Vector(o*i,-1*a,o*n)}}],(n=[{key:"add",value:function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z}},{key:"sub",value:function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z}},{key:"mult",value:function(t){this.x*=t,this.y*=t,this.z*=t}},{key:"div",value:function(t){0!==t?(this.x/=t,this.y/=t,this.z/=t):console.warn("Dividing by zero!")}},{key:"angleBetween",value:function(e){return t.sub(e,this).heading()}},{key:"copy",value:function(){return new t(this.x,this.y,this.z)}},{key:"cross",value:function(e){return new t(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}},{key:"dist",value:function(e){return t.sub(e,this).magnitude()}},{key:"distSq",value:function(e){return t.sub(e,this).magSq()}},{key:"dot",value:function(t){return this.x*(t.x||0)+this.y*(t.y||0)+this.z*(t.z||0)}},{key:"equals",value:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z}},{key:"heading",value:function(){return Math.atan2(this.y,this.x)}},{key:"lerp",value:function(e,n,i,a){e instanceof t?this.lerp(e.x,e.y,e.z,n):(this.x+=(e-this.x)*a||0,this.y+=(n-this.y)*a||0,this.z+=(i-this.z)*a||0)}},{key:"limit",value:function(t){var e=this.magnitude;e*e>t*t&&(this.div(e),this.mult(t))}},{key:"normalise",value:function(){var t=this.magnitude();0!==t&&this.mult(1/t)}},{key:"magnitude",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"magSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}}])&&u(e.prototype,n),i&&u(e,i),t}();function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=this.getVelocity(e);this.location=e.location.copy(),this.velocity=n,this.angle=n.heading(),this.stats={speed:10,limit:100,damage:e.stats.attack},this.state={origin:e.state.id,id:l(),distanceTravelled:0}}var e,n;return e=t,(n=[{key:"checkCollisions",value:function(t){var e=this,n=null,i=[],a=this.getFutureLocation(t),o=c.sub(a,this.location),r=o.magnitude();o.normalise(),t.getBulletUnits(this.location,a).forEach((function(t){if(t.state.id!==e.state.origin){var n=c.sub(t.location,e.location),s=n.magnitude();if(n.normalise(),s<=e.stats.speed&&a.dist(t.location)<=e.stats.speed){var l=Math.acos(o.dot(n)/(r*s));Math.sin(l)*s<1.5*t.size.x&&i.push({unit:t,distance:s})}}})),i.length&&(i.forEach((function(t){n?t.distance<n.distance&&(n=t):n=t})),n.unit.applyDamage(this.stats.damage),this.state.distanceTravelled=2*this.limit)}},{key:"getVelocity",value:function(t){var e=c.sub(t.state.target.location,t.location);return e.normalise(),e.mult(10),e}},{key:"getFutureLocation",value:function(t){var e=c.add(this.location,this.velocity);return e.x<0?e.x=0:e.x>t.width?e.x=t.width-1:e.y<0?e.y=0:e.y>t.height&&(e.y=t.height-1),e}},{key:"updateLocation",value:function(){this.location.add(this.velocity),this.state.distanceTravelled+=this.stats.speed}}])&&h(e.prototype,n),t}(),v=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=n.g.WIDTH,this.height=n.g.HEIGHT};function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"degreesToRadians",value:function(t){return t*Math.PI/180}},{key:"random",value:function(t,e){var n=e-t;return Math.random()*n+t}},{key:"gaussian",value:function(){for(var t=0,e=0;0===t;)t=Math.random();for(;0===e;)e=Math.random();return Math.sqrt(-1*Math.log(t))*Math.cos(1*Math.PI*e)}},{key:"mean",value:function(t){return t.reduce((function(t,e){return t+e}))/t.length}},{key:"meanVector",value:function(t){var e,n=new c,i=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;n.x+=a.x,n.y+=a.y,n.z+=a.z}}catch(t){i.e(t)}finally{i.f()}return n.div(t.length),n}},{key:"map",value:function(t,e,n,i,a){return t/(e-n)*(i-a)}},{key:"shuffle",value:function(t){for(var e,n,i=t.length;i;)n=Math.floor(Math.random()*i--),e=t[i],t[i]=t[n],t[n]=e;return t}}],null&&y(e.prototype,null),n&&y(e,n),t}();function g(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var x=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;b(this,t),this.head=e,this.tail=e,this.length=e?1:0}var e,n;return e=t,n=[{key:"getAll",value:function(){for(var t=[],e=this.head;e;)t.push(e.value),e=e.next;return t}},{key:"printList",value:function(){for(var t=[],e=this.head;null!==e;)t.push(e),e=e.next;console.log([].concat(t))}},{key:"prepend",value:function(t){var e=new A(t);0===this.length?(this.head=e,this.tail=this.head):(e.next=this.head,this.head.previous=e,this.head=e),this.length++}},{key:"append",value:function(t){var e=new A(t);0===this.length?(this.head=e,this.tail=this.head):(this.tail.next=e,e.previous=this.tail,this.tail=e),this.length++}},{key:"insert",value:function(t,e){if(e<0||e>this.length||!Number.isInteger(e))console.warn("Index is not a valid integer! Current length ".concat(this.length));else{if(0===e)this.prepend(t);else if(e===this.length)this.append(t);else{for(var n=new A(t),i=this.head,a=0;a<e-1;a++)i=i.next;var o=i.next;n.next=o,i.next=n,n.previous=i,o.previous=n}this.length++}}},{key:"merge",value:function(e){var n=this;!e instanceof t?console.warn("LinkedList.merge must be passed an instance of a LinkedList"):e.getAll().forEach((function(t){return n.append(t)}))}},{key:"activateNodes",value:function(t){var e,n=0;e=t.constructor===Array?t:[t];for(var i=this.head;i;){var a,o=g(e);try{for(o.s();!(a=o.n()).done;){var r=a.value;i.value==r&&(i.active=!0,n+=1)}}catch(t){o.e(t)}finally{o.f()}if(n===e.length)return;i=i.next}}},{key:"deactivateNodes",value:function(t){var e,n=0;e=t.constructor===Array?t:[t];for(var i=this.head;i;){var a,o=g(e);try{for(o.s();!(a=o.n()).done;){var r=a.value;i.value==r&&(i.active=!1,n+=1)}}catch(t){o.e(t)}finally{o.f()}if(n===e.length)return;i=i.next}}},{key:"removeById",value:function(t){for(var e=this.head;e;){if(e.value.state.id===t)return e.previous&&e.next?(e.previous.next=e.next,e.next.previous=e.previous):e.previous?(this.tail=e.previous,this.tail.next=null):e.next?(this.head=e.next,this.head.previous=null):(this.head=null,this.tail=this.head),void this.length--;e=e.next}console.warn("Node with unit.id: ".concat(t," not found in list!"))}},{key:"removeByValues",value:function(t){var e,n=0;e=t.constructor===Array?t:[t];for(var i=this.head;i;){var a,o=g(e);try{for(o.s();!(a=o.n()).done;){var r=a.value;i.value==r&&(i.previous&&i.next?(i.previous.next=i.next,i.next.previous=i.previous):i.previous?(this.tail=i.previous,this.tail.next=null):i.next?(this.head=i.next,this.head.previous=null):(this.head=null,this.tail=this.head),this.length--,n+=1)}}catch(t){o.e(t)}finally{o.f()}if(n===e.length)return;i=i.next}console.warn('"'.concat(array.join(", "),'" not found in list!'))}}],n&&w(e.prototype,n),t}(),A=function t(e){b(this,t),this.value=e,this.previous=null,this.next=null};function k(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return T(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function E(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var I=function(){function t(e,i,a,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=n.g.platoonTotals;r[o]=r[o]+1,this.location=this.getMeanLocation(a),this.stats={team:o,FOV:130},this.state={behaviour:"NON-COMBAT",action:"REST",destination:0,previous:performance.now(),id:l()},this.units=this.populate(a),this.updateStats()}var e,i;return e=t,(i=[{key:"populate",value:function(t){var e,n=new x,i=k(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;a.state.platoon=this,a.state.action="PLATOON",n.append(a)}}catch(t){i.e(t)}finally{i.f()}return n}},{key:"updateStats",value:function(){var t,e=1e3,n=0,i=0,a=k(this.units.getAll());try{for(a.s();!(t=a.n()).done;){var o=t.value;e=o.stats.speed<e?o.stats.speed:e,n=o.stats.acuity>n?o.stats.acuity:n,i=o.stats.restTime>i?o.stats.restTime:i}}catch(t){a.e(t)}finally{a.f()}this.stats.speed=e,this.stats.acuity=n,this.stats.restTime=i}},{key:"update",value:function(){"NON-COMBAT"===this.state.behaviour?"PATROL"===this.state.action?this.patrol():"REST"===this.state.action&&this.rest():this.state.behaviour,this.location=this.getMeanLocation(this.units.getAll())}},{key:"patrol",value:function(){var t=this;this.units.getAll().every((function(e){return e.location.dist(t.state.destination)<e.size.y*(e.size.x/2)}))?(this.state.destination=null,this.state.action="REST",this.state.previous=performance.now()):this.moveUnits()}},{key:"rest",value:function(){performance.now()-this.state.previous>1e3*this.stats.restTime&&(this.state.action="PATROL",this.getDestination())}},{key:"moveUnits",value:function(){var t,e=this.units.getAll(),n=k(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.location.dist(this.state.destination)>2*i.size.y&&i.seek(this.state.destination),this.flock(i,e),i.updateLocation()}}catch(t){n.e(t)}finally{n.f()}}},{key:"flock",value:function(t,e){var n=t.avoid(e),i=t.cohere(e),a=t.align(e);n.mult(.2),i.mult(.2),a.mult(.2),t.applyBehaviour(n),t.applyBehaviour(i),t.applyBehaviour(a)}},{key:"addUnit",value:function(t){t.state.platoon=this,t.state.action=this.state.action,this.units.append(t),this.updateStats()}},{key:"getDestination",value:function(){var t=n.g,e=t.WIDTH,i=t.HEIGHT,a=new c(Math.random()*e,Math.random()*i),o=c.sub(a,this.location),r=o.magnitude();o.normalise(),r>2*this.stats.acuity&&(o.mult(2*this.stats.acuity),a.x=this.location.x+o.x,a.y=this.location.y+o.y),this.state.destination=a}},{key:"getMeanLocation",value:function(t){var e,n=new c,i=k(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;n.add(a.location)}}catch(t){i.e(t)}finally{i.f()}return n.div(t.length),n}},{key:"checkEdges",value:function(){var t,e=k(this.units.getAll());try{for(e.s();!(t=e.n()).done;)t.value.checkEdges()}catch(t){e.e(t)}finally{e.f()}}}])&&E(e.prototype,i),t}();const O={WHITE:[255,255,255],GREY:[100,100,100],BLACK:[0,0,0],teams:{RED:[235,60,39],BLUE:[35,98,162],GREEN:[3,160,98],YELLOW:[251,183,65]}};function S(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var C=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"getRGB",value:function(t){return"rgb(".concat(t[0],", ").concat(t[1],", ").concat(t[2],")")}},{key:"getRGBA",value:function(t,e){return"rgba(".concat(t[0],", ").concat(t[1],", ").concat(t[2],", ").concat(e,")")}}],null&&S(e.prototype,null),n&&S(e,n),t}();function H(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return B(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function z(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var L=function(){function t(e,i,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var o=n.g.unitTotals;o[a]=o[a]+1,this.location=new c(e,i),this.velocity=new c(p.random(-1,1),p.random(-1,1)),this.acceleration=new c,this.size=new c(4,8),this.angle=this.velocity.heading(),this.angleOffset=0,this.velocity.mult(0);var r=20+2*p.gaussian(),s=1+.25*p.gaussian(),u=20*this.size.x+p.gaussian()*this.size.x*2,h=.75*u,f=p.random(2,4);this.stats={team:a,health:100,attack:r,speed:s,FOV:130,acuity:u,range:h,restTime:f},this.state={id:l(),platoon:null,behaviour:"NON-COMBAT",action:"REST",destination:null,target:null,previous:performance.now(),colour:C.getRGB(O.teams[a])}}var e,i;return e=t,(i=[{key:"performBehaviour",value:function(t){if(!this.state.target&&t.length>=1){var e=this.getNearestEntity(t);e&&(e.stats.team!==this.stats.team?(this.state.behaviour="COMBAT",this.state.action="ATTACK",this.state.target=e):e.stats.team===this.stats.team&&("NON-COMBAT"===e.state.behaviour&&"JOIN"!==e.state.action?(this.state.action="JOIN",this.state.target=e,this.state.destination=e.location,e.state.action="JOIN",e.state.target=this,e.state.destination=this.location):"PLATOON"===e.state.behaviour&&(this.state.action="JOIN",this.state.target=e,this.state.destination=e.location)))}"NON-COMBAT"===this.state.behaviour?this.nonCombatBehaviour():"COMBAT"===this.state.behaviour&&this.combatBehaviour()}},{key:"nonCombatBehaviour",value:function(){"PATROL"===this.state.action?this.patrol():"REST"===this.state.action?this.rest():"JOIN"===this.state.action&&this.join()}},{key:"combatBehaviour",value:function(){"ATTACK"===this.state.action?this.attack():this.state.action}},{key:"patrol",value:function(){this.location.equals(this.state.destination)?(this.state.destination=null,this.state.action="REST",this.state.previous=performance.now()):this.location.dist(this.state.destination)<this.stats.speed?this.location=this.state.destination.copy():(this.seek(this.state.destination),this.updateLocation())}},{key:"rest",value:function(){performance.now()-this.state.previous>1e3*this.stats.restTime&&(this.state.action="PATROL",this.getDestination(),this.seek(this.state.destination),this.angleOffset=0)}},{key:"join",value:function(){if(this.location.dist(this.state.target.location)<this.size.y*(this.size.x/2)){var t=this.state.target;if("PLATOON"===t.state.behaviour)this.state.target=null,this.state.destination=null,this.state.behaviour="PLATOON",this.state.action="JOINING",this.state.platoon=t.state.platoon.state.id;else{var e=l();this.state.target=null,this.state.destination=null,this.state.behaviour="PLATOON",this.state.action="JOINING",this.state.platoon=e,t.state.target=null,t.state.destination=null,t.state.behaviour="PLATOON",t.state.action="JOINING",t.state.platoon=e}}else this.seek(this.state.target.location),this.updateLocation()}},{key:"attack",value:function(){this.location.dist(this.state.target.location)<=this.stats.range?performance.now()-this.state.previous>=1e3&&(this.state.action="FIRE",this.state.previous=performance.now()):this.location.dist(this.state.target.location)<=this.stats.acuity?(this.seek(this.state.target.location),this.updateLocation()):this.state.action="SEARCH"}},{key:"seek",value:function(t){var e=c.sub(t,this.location);e.normalise(),e.mult(this.stats.acuity/2);var n=p.random(0,2*Math.PI),i=this.size.y,a=c.add(e,new c(Math.cos(n)*i,Math.sin(n)*i));a.normalise(),a.mult(this.getSpeed()),a.sub(this.velocity),this.angle=e.heading()+p.map(Math.cos(this.angleOffset),0-Math.PI,Math.PI,.25*Math.PI,.75*Math.PI),this.angleOffset+=.25*this.stats.speed,this.applyBehaviour(a)}},{key:"avoid",value:function(t){var e,n=new c,i=1*this.size.y,a=0,o=H(t);try{for(o.s();!(e=o.n()).done;){var r=e.value,s=this.location.dist(r.location);if(s>0&&s<i){var l=c.sub(r.location,this.location);l.normalise(),l.div(s),l.mult(-1),n.add(l),a++}}}catch(t){o.e(t)}finally{o.f()}if(a>=1&&(n.div(a),n.normalise(),n.mult(this.getSpeed()),n.sub(this.velocity)),"PLATOON"===this.state.behaviour)return n;this.applyBehaviour(n)}},{key:"cohere",value:function(t){var e,n=new c(0,0),i=4*this.size.y,a=0,o=H(t);try{for(o.s();!(e=o.n()).done;){var r=e.value,s=this.location.dist(r.location);if(s>0&&s>i){var l=c.sub(r.location,this.location);l.normalise(),l.div(s),n.add(l),a++}}}catch(t){o.e(t)}finally{o.f()}if(a>=1&&(n.div(a),n.normalise(),n.mult(this.getSpeed()),n.sub(this.velocity)),"PLATOON"===this.state.behaviour)return n;this.applyBehaviour(n)}},{key:"align",value:function(t){var e,n=new c,i=H(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;this.state.id!==a.state.id&&n.add(a.velocity)}}catch(t){i.e(t)}finally{i.f()}if(n.div(t.length),n.normalise(),n.mult(this.getSpeed()),n.sub(this.velocity),"PLATOON"===this.state.behaviour)return n;this.applyBehaviour(n)}},{key:"getDestination",value:function(){var t=n.g,e=t.WIDTH,i=t.HEIGHT,a=new c(Math.random()*e,Math.random()*i),o=c.sub(a,this.location),r=o.magnitude();o.normalise(),r>2*this.stats.acuity&&(o.mult(2*this.stats.acuity),a.x=this.location.x+o.x,a.y=this.location.y+o.y),this.state.destination=a}},{key:"updateLocation",value:function(){this.velocity.add(this.acceleration),this.velocity.limit(this.getSpeed()),this.location.add(this.velocity),this.acceleration.mult(0)}},{key:"getNearestEntity",value:function(t){var e,n,i=1e6,a=H(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,r=this.location.dist(o.location);r<i&&(i=r,e=o)}}catch(t){a.e(t)}finally{a.f()}return e||!1}},{key:"applyBehaviour",value:function(t){this.acceleration.add(t)}},{key:"applyDamage",value:function(t){this.stats.health-=t}},{key:"getSpeed",value:function(){return"PLATOON"===this.state.behaviour?this.state.platoon.stats.speed:this.stats.speed}},{key:"checkEdges",value:function(){var t=n.g,e=t.WIDTH,i=t.HEIGHT;this.location.x<this.size.x?this.location.x=this.size.x:this.location.x>e-this.size.x&&(this.location.x=e-this.size.x),this.location.y<this.size.x?this.location.y=this.size.x:this.location.y>i-this.size.x&&(this.location.y=i-this.size.x)}}])&&z(e.prototype,i),t}();function R(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return P(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}function P(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function M(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var N=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=n.g.WIDTH,this.height=n.g.HEIGHT,this.cellsX=e,this.cellsY=i,this.cellSize=new c(n.g.WIDTH/e,n.g.HEIGHT/i),this.cells=this.initaliseCells()}var e,i;return e=t,(i=[{key:"initaliseCells",value:function(){for(var t=[],e=0;e<this.cellsY;e++){for(var n=[],i=0;i<this.cellsX;i++)n.push({position:new c(i,e),obstacles:new x,units:new x,ballistics:new x});t.push(n)}return t}},{key:"getCellFromVector",value:function(t){var e=Math.floor(t.x/this.cellSize.x),n=Math.floor(t.y/this.cellSize.y);return this.cells[n][e]}},{key:"updateCells",value:function(){var t,e=R(this.cells);try{for(e.s();!(t=e.n()).done;){var n,i=R(t.value);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,r=R(o.units.getAll());try{for(r.s();!(a=r.n()).done;){var s=a.value,l=this.getCellFromVector(s.location);o.position.equals(l.position)||(o.units.removeById(s.state.id),l.units.append(s))}}catch(t){r.e(t)}finally{r.f()}var u,c=R(o.ballistics.getAll());try{for(c.s();!(u=c.n()).done;){var h=u.value,f=this.getCellFromVector(h.location);o.position.equals(f.position)||(o.ballistics.removeById(h.state.id),f.ballistics.append(h))}}catch(t){c.e(t)}finally{c.f()}}}catch(t){i.e(t)}finally{i.f()}}}catch(t){e.e(t)}finally{e.f()}}},{key:"getBulletUnits",value:function(t,e){var n=[],i=this.getCellFromVector(t),a=this.getCellFromVector(e);return i==a?i.units.getAll().forEach((function(t){n.push(t)})):(i.units.getAll().forEach((function(t){n.push(t)})),a.units.getAll().forEach((function(t){n.push(t)}))),n}},{key:"getVisibleUnits",value:function(t){var e=this.getCellFromVector(t.location),n=this.getNeighbouringCells(e),i=[],a=t.velocity.copy();a.normalise();var o,r=R(n);try{for(r.s();!(o=r.n()).done;)for(var s=o.value.units.head;s;){var l=s.value;if(t.state.id===l.state.id)s=s.next;else{if((l.location.x-t.location.x)*(l.location.x-t.location.x)+(l.location.y-t.location.y)*(l.location.y-t.location.y)<t.stats.acuity*t.stats.acuity){var u=new c(l.location.x-t.location.x,l.location.y-t.location.y);u.normalise();var h=a.dot(u);p.map(h,-1,1,180,0)<t.stats.FOV/2&&i.push(l)}s=s.next}}}catch(t){r.e(t)}finally{r.f()}return i}},{key:"getNeighbouringCells",value:function(t){var e=[t.position.x],n=[t.position.y];0===t.position.x?e.push(t.position.x+1):t.position.x===this.cellsX-1?e.push(t.position.x-1):(e.push(t.position.x-1),e.push(t.position.x+1)),0===t.position.y?n.push(t.position.y+1):t.position.y===this.cellsY-1?n.push(t.position.y-1):(n.push(t.position.y-1),n.push(t.position.y+1));for(var i=[],a=0;a<n.length;a++)for(var o=0;o<e.length;o++)i.push(this.cells[n[a]][e[o]]);return i}},{key:"createPlatoon",value:function(t){var e=t[0].location,n=new I(e.x,e.y,t),i=this.getCellFromVector(t[0].location);i.platoons.append(n),i.units.deactivateNodes(t)}},{key:"addUnitToPlatoon",value:function(t,e){e.units.append(t),this.getCellFromVector(t.location).units.deactivateNodes(t)}}])&&M(e.prototype,i),t}();function G(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var j=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i;return e=t,i=[{key:"init",value:function(e){this.initialiseCanvas(e);var n=t.initialiseGrid(),i=t.initialiseMap(),a=t.initialiseUnits(n);return{grid:n,map:i,platoons:new x,units:a,ballistics:new x}}},{key:"initialiseCanvas",value:function(t){var e=window.innerWidth-2*t,i=window.innerHeight-2*t,a=document.createElement("div");a.id="container",a.style.padding="".concat(t,"px");var o=document.createElement("canvas");o.width=e,o.height=i;var r=o.getContext("2d");a.appendChild(o),document.body.appendChild(a),n.g={canvas:o,context:r,WIDTH:e,HEIGHT:i,unitTotals:{RED:0,BLUE:0,GREEN:0,YELLOW:0},platoonTotals:{RED:0,BLUE:0,GREEN:0,YELLOW:0}}}},{key:"initialiseMap",value:function(){return new v}},{key:"initialiseGrid",value:function(){var t,e,i=n.g,a=i.WIDTH,o=i.HEIGHT;return a>o?(t=6,e=4):a<o?(t=4,e=6):a===o&&(t=6,e=6),new N(t,e)}},{key:"initialiseUnits",value:function(t){for(var e,i=new x,a=0;a<40;a++){var o=void 0;a%4==0?(e="RED",o=new c(p.random(0,n.g.WIDTH/2),p.random(0,n.g.HEIGHT/2))):a%4==1?(e="BLUE",o=new c(p.random(n.g.WIDTH/2,n.g.WIDTH),p.random(0,n.g.HEIGHT/2))):a%4==2?(e="GREEN",o=new c(p.random(0,n.g.WIDTH/2),p.random(n.g.HEIGHT/2,n.g.HEIGHT))):a%4==3&&(e="YELLOW",o=new c(p.random(n.g.WIDTH/2,n.g.WIDTH),p.random(n.g.HEIGHT/2,n.g.HEIGHT)));var r=new L(o.x,o.y,e);i.append(r),t.getCellFromVector(o).units.append(r)}return i}},{key:"initialisePlatoons",value:function(t){for(var e=new x,i=new x,a=0;a<4;a++){var o=void 0,r=void 0,s=[];a%4==0?(o="RED",r=new c(p.random(50,n.g.WIDTH/2),p.random(50,n.g.HEIGHT/2))):a%4==1?(o="BLUE",r=new c(p.random(n.g.WIDTH/2,n.g.WIDTH-50),p.random(50,n.g.HEIGHT/2))):a%4==2?(o="GREEN",r=new c(p.random(50,n.g.WIDTH/2),p.random(n.g.HEIGHT/2,n.g.HEIGHT-50))):a%4==3&&(o="YELLOW",r=new c(p.random(n.g.WIDTH/2,n.g.WIDTH-50),p.random(n.g.HEIGHT/2,n.g.HEIGHT-50)));for(var l=0;l<6;l++){var u=new L(r.x+p.random(-20,20),r.y+p.random(-20,20),o);u.state.behaviour="PLATOON",u.state.action="PLATOON",i.append(u),s.push(u),t.getCellFromVector(u.location).units.append(u)}e.append(new I(r.x,r.y,s,o))}return{platoons:e,units:i}}}],null&&G(e.prototype,null),i&&G(e,i),t}();function D(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var U=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i;return e=t,i=[{key:"clear",value:function(){var t=n.g,e=t.context,i=t.WIDTH,a=t.HEIGHT;e.clearRect(0,0,i,a)}},{key:"renderOverlay",value:function(){var t=n.g,e=t.context,i=t.platoonTotals,a=t.unitTotals;e.font="16px PressStart2P",e.textBaseline="top",e.textAlign="center",e.fillStyle=C.getRGBA(O.teams.RED,.5),e.fillText(a.RED,20,20),e.fillText(i.RED,20,50),e.fillStyle=C.getRGBA(O.teams.BLUE,.5),e.fillText(a.BLUE,80,20),e.fillText(i.BLUE,80,50),e.fillStyle=C.getRGBA(O.teams.GREEN,.5),e.fillText(a.GREEN,140,20),e.fillText(i.GREEN,140,50),e.fillStyle=C.getRGBA(O.teams.YELLOW,.5),e.fillText(a.YELLOW,200,20),e.fillText(i.YELLOW,200,50)}},{key:"renderGrid",value:function(t){for(var e=n.g.context,i=0;i<t.cellsY;i++)for(var a=0;a<t.cellsX;a++)e.strokeStyle=C.getRGBA(O.GREY,.3),e.strokeRect(a*t.cellSize.x,i*t.cellSize.y,t.cellSize.x,t.cellSize.y)}},{key:"renderAllPlatoons",value:function(t){var e=this;t.forEach((function(t){e.renderPlatoon(t)}))}},{key:"renderAllUnits",value:function(t){var e=this;t.forEach((function(t){e.renderUnit(t)}))}},{key:"renderAllBallistics",value:function(t){var e=this;t.forEach((function(t){e.renderBallistic(t)}))}},{key:"renderPlatoon",value:function(t){var e=n.g.context;e.save(),e.translate(t.location.x,t.location.y),e.beginPath(),e.fillStyle=C.getRGBA(O.GREY,.3),e.arc(0,0,10,0,2*Math.PI),e.fill(),e.closePath(),e.restore()}},{key:"renderUnit",value:function(t){var e=n.g.context;e.save(),e.translate(t.location.x,t.location.y),e.rotate(t.angle),t.stats.health>0?e.fillStyle=t.state.colour:e.fillStyle=C.getRGB(O.GREY),e.fillRect(-.25*t.size.x,-.5*t.size.y,.5*t.size.x,.25*t.size.y),e.fillRect(-.25*t.size.x,.25*t.size.y,.5*t.size.x,.25*t.size.y),e.fillRect(-.5*t.size.x,-.25*t.size.y,t.size.x,.5*t.size.y),e.restore()}},{key:"renderBallistic",value:function(t){var e=n.g.context;e.save(),e.translate(t.location.x,t.location.y),e.rotate(t.angle),e.fillStyle=C.getRGB(O.WHITE),e.fillRect(0,0,2,2),e.restore()}},{key:"renderPause",value:function(){var t=n.g,e=t.context,i=t.WIDTH,a=t.HEIGHT;e.font="32px PressStart2P",e.textBaseline="top",e.textAlign="center",e.fillStyle=C.getRGB(O.WHITE),e.fillText("PAUSED",i/2,a/2-15)}}],null&&D(e.prototype,null),i&&D(e,i),t}();function W(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,a,o=[],r=!0,s=!1;try{for(n=n.call(t);!(r=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);r=!0);}catch(t){s=!0,a=t}finally{try{r||null==n.return||n.return()}finally{if(s)throw a}}return o}}(t,e)||F(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=F(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}function F(t,e){if(t){if("string"==typeof t)return Y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(t,e):void 0}}function Y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function q(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var J=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e=j.init(20),n=e.grid,i=e.map,a=e.platoons,o=e.units,r=e.ballistics;this.grid=n,this.map=i,this.platoons=a,this.units=o,this.ballistics=r,this.running=!0,this.previous=performance.now()}var e,i;return e=t,i=[{key:"run",value:function(){this.draw(),this.running&&(this.updateAI(),this.updatePhysics(),this.grid.updateCells(),this.updatePlatoons()),requestAnimationFrame(this.run.bind(this))}},{key:"draw",value:function(){U.clear(),U.renderGrid(this.grid),U.renderOverlay(),U.renderAllPlatoons(this.platoons.getAll()),U.renderAllUnits(this.units.getAll()),U.renderAllBallistics(this.ballistics.getAll()),this.running||(performance.now()-this.previous)%1600<800&&U.renderPause()}},{key:"updateAI",value:function(){var t,e=V(this.platoons.getAll());try{for(e.s();!(t=e.n()).done;)t.value.update()}catch(t){e.e(t)}finally{e.f()}var n,i=V(this.units.getAll());try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this.grid.getVisibleUnits(a);"PLATOON"!==a.state.behaviour&&a.performBehaviour(o)}}catch(t){i.e(t)}finally{i.f()}}},{key:"updatePhysics",value:function(){var t,e=n.g,i=e.WIDTH,a=e.HEIGHT,o=V(this.ballistics.getAll());try{for(o.s();!(t=o.n()).done;){var r=t.value;r.checkCollisions(this.grid),r.state.distanceTravelled<=r.stats.limit?(r.updateLocation(),(r.location.x<0||r.location.x>i||r.location.y<0||r.location.y>a)&&(this.grid.getCellFromVector(r.location).ballistics.removeById(r.state.id),this.ballistics.removeById(r.state.id))):(this.grid.getCellFromVector(r.location).ballistics.removeById(r.state.id),this.ballistics.removeById(r.state.id))}}catch(t){o.e(t)}finally{o.f()}var s,l=V(this.units.getAll());try{for(l.s();!(s=l.n()).done;){var u=s.value;if(u.checkEdges(),"FIRE"===u.state.action){var c=this.grid.getCellFromVector(u.location),h=new f(u);c.ballistics.append(h),this.ballistics.append(h),u.state.action="ATTACK"}}}catch(t){l.e(t)}finally{l.f()}}},{key:"updatePlatoons",value:function(){var t,e={},n=this.platoons.getAll().map((function(t){return t.state.id})),i=V(this.units.getAll());try{for(i.s();!(t=i.n()).done;){var a=t.value;if("PLATOON"===a.state.behaviour&&"JOINING"===a.state.action)if(n.includes(a.state.platoon)){var o,r=V(this.platoons.getAll());try{for(r.s();!(o=r.n()).done;){var s=o.value;s.state.id===a.state.platoon&&s.addUnit(a)}}catch(t){r.e(t)}finally{r.f()}}else e.hasOwnProperty(a.state.platoon)?e[a.state.platoon].push(a):e[a.state.platoon]=[a]}}catch(t){i.e(t)}finally{i.f()}if(Object.entries(e).length>=1)for(var l=0,u=Object.entries(e);l<u.length;l++){var c=W(u[l],2),h=(c[0],c[1]),f=h.map((function(t){return t.location})),v=p.meanVector(f),d=h[0].stats.team;this.platoons.append(new I(v.x,v.y,h,d))}var y,g=V(this.platoons.getAll());try{for(g.s();!(y=g.n()).done;){var m=y.value;if(m.units.length>=10){var b=m.units.getAll();b=p.shuffle(b);for(var w=[],x=m.location.copy(),A=0;A<5;A++)m.units.removeById(b[A].state.id),w.push(b[A]);this.platoons.append(new I(x.x,x.y,w,m.stats.team))}}}catch(t){g.e(t)}finally{g.f()}}}],i&&q(e.prototype,i),t}(),$=n(379),X=n.n($),Z=n(795),_=n.n(Z),K=n(569),Q=n.n(K),tt=n(565),et=n.n(tt),nt=n(216),it=n.n(nt),at=n(589),ot=n.n(at),rt=n(426),st={};st.styleTagTransform=ot(),st.setAttributes=et(),st.insert=Q().bind(null,"head"),st.domAPI=_(),st.insertStyleElement=it(),X()(rt.Z,st),rt.Z&&rt.Z.locals&&rt.Z.locals;var lt=new J;document.addEventListener("keyup",(function(t){"p"===t.key&&(lt.running=!lt.running,lt.pauseVisible=!0,lt.previous=performance.now())})),lt.run()})()})();
//# sourceMappingURL=main.js.map